<footer class="site-footer">
    <section class="partners" id="partners">
      <ul>
        <li><a href="https://www.vaticanlibrary.va/home.php" target="_blank"><img src="/assets/images/vatican.png" alt="Biblioteca Apostolica Vaticana" title="Biblioteca Apostolica Vaticana" /></a></li>
        <li><a href="http://library.columbia.edu/" target="_blank"><img src="/assets/images/columbia.png" alt="Columbia University Library" title="Columbia University Library" /></a></li>
        <li><a href="http://www.frick.org/research/library" target="_blank"><img src="/assets/images/frick.png" alt="Frick Art Reference Library" title="Frick Art Reference Library" /></a></li>
        <li><a href="https://www.getty.edu/research/" target="_blank"><img src="/assets/images/getty.png" alt="Getty Research Institute" title="Getty Research Institute" /></a></li>
        <li><a href="http://library.harvard.edu/" target="_blank"><img src="/assets/images/harvard.png" alt="Harvard University Library" title="Harvard University Library" /></a></li>
        <li><a href="http://www.ub.uni-heidelberg.de/" target="_blank"><img src="/assets/images/heidelberg.png" alt="Heidelberg University Library" title="Heidelberg University Library" /></a></li>
        <li><a href="https://library.nga.gov/" target="_blank"><img src="/assets/images/national_gallery_of_art.png" alt="National Gallery of Art Library" title="National Gallery of Art Library" /></a></li>
        <li><a href="http://library.princeton.edu/" target="_blank"><img src="/assets/images/princeton.png" alt="Princeton University Library" title="Princeton University Library" /></a></li>
        <li><a href="http://www.library.illinois.edu/" target="_blank"><img src="/assets/images/illinois.png" alt="University of Illinois at Urbana-Champaign Library" title="University of Illinois at Urbana-Champaign Library" /></a></li>
      </ul>
      <span class="footer-bottom">&copy; {{ 'now' | date: "%Y" }} The Trustees of Princeton University. All rights reserved.</span>
    </section>
</footer>

// <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>
<script src="/assets/fuseindex.js"></script>

<script>
  // Adapted from https://www.fusejs.io/demo.html
  var runSearch = function() {
    var i, item;

    const fuseOptions = {
            keys: ["filename",
               "ciconum",
               "author",
               "title",
               "people",
               "orgs",
               "languages",
               "dates",
               "places",
               "keywords",
              ],
    };

    // Clear the previous results
    var searchResultsDiv = document.getElementById("searchResults");
    searchResultsDiv.innerHTML = "";

    // Run the search
    const fuse = new Fuse(searchIndex, fuseOptions);
    const searchTerms = document.getElementById("searchTerms").value;
    const results = fuse.search(searchTerms);
    if (results.length == 0) {
      searchResultsDiv.innerHTML = `<p>No results were found for ${searchTerms}</p>`;
      return;
    }

    // Display the total number of results found
    var totalsEl = document.createElement("p");
    totalsEl.textContent = `${results.length} results were found`;
    searchResultsDiv.appendChild(totalsEl);

    // Loop throught results and add them to the page
    for(i = 0; i < results.length; i++) {
    // var resultEl = document.createElement("p");
      var result = results[i].item;

      var linkEl = document.createElement("a");
      linkEl.href = `/catalogo/${result.filename}`;
      linkEl.text = result.title[1];

      // var resultEl = document.createElement("p");
      
      var resultDl = document.createElement("dl");
      resultDl.classList.add("compact");
      searchResultsDiv.appendChild(resultDl);

      var resultDt = document.createElement("dt");
      resultDt.appendChild(document.createTextNode('ciconum'));
      resultDl.appendChild(resultDt);
      
      var resultDd = document.createElement("dd");
      resultDd.appendChild(document.createTextNode(result.ciconum));
      resultDl.appendChild(resultDd);
      
      var resultDt = document.createElement("dt");
      resultDt.appendChild(document.createTextNode('author'));
      resultDl.appendChild(resultDt);
      
      var resultDd = document.createElement("dd");
      resultDd.appendChild(document.createTextNode(result.author));
      resultDl.appendChild(resultDd);
      
      var resultDt = document.createElement("dt");
      resultDt.appendChild(document.createTextNode('title'));
      resultDl.appendChild(resultDt);
      
      var resultDd = document.createElement("dd");
      resultDd.appendChild(linkEl);
      resultDl.appendChild(resultDd);

      // resultEl.appendChild(linkEl);
      // searchResultsDiv.appendChild(resultEl);
    }
  }

  // Wire the search button to run the serch
  document.getElementById("searchButton").addEventListener("click", (event) => {
    runSearch();
  });

  // Wire the enter key on the search textbox to run the search
  // Source https://stackoverflow.com/a/46063448/446681
  document.getElementById("searchTerms").addEventListener("keyup", (event) => {
    if (event.key === "Enter") {
      runSearch();
    }
  });

  // Give the focus to the search box
  document.getElementById("searchTerms").focus();
</script>
